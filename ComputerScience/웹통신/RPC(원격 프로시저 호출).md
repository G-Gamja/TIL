위키피디아: https://ko.wikipedia.org/wiki/%EC%9B%90%EA%B2%A9_%ED%94%84%EB%A1%9C%EC%8B%9C%EC%A0%80_%ED%98%B8%EC%B6%9C

한글블로그: https://co-no.tistory.com/28

동작방식: https://minisp.tistory.com/12

: Remote Procedure Call(원격 프로시저 호출)의 약자로, 별도의 원격 제어를 위한 코딩 없이 다른 주소 공간에서 *함수나 **프로시저를 실행할 수 있게 하는 프로세스 간 통신 기술을 말한다.

 다시 말해, RPC를 이용하면 프로그래머는 함수 또는 프로시저가 실행 프로그램이 존재하는 로컬 위치에 있든, 원격 위치에 있든 상관없이 동일한 기능을 수행할 수 있음을 의미한다.

이게 중요한건데 -> 클라이언트에서는 직접 서버 코드의 함수를 호출하는 것처럼 보인다. 로컬에서 오브젝트.메서드 이렇게 실행시킬 수 있으니까

* 함수(Function) : Input에 따른 Output의 발생을 목적으로 한다. 따라서 Return값을 필수로 가져야 하며, Client단에서 처리되기 때문에 주로 간단한 계산 및 수치 등을 도출할 때 사용한다. 

* 프로시저(Procedure) : Output값 자체에 집중하기보단, '명령 단위가 수행하는 절차'에 집중한 개념이라고 보면 된다.

따라서 Return값이 있을수도 있고, 없을수도 있으며, Server단에서 처리되기 때문에 함수보다 큰 단위의 실행, 프로세싱 등을 할 때 사용한다.

"RPC를 어떨 때 쓰나"

 일반적으로 프로세스(Process)는 자신의 주소공간 안에 존재하는 함수만 호출하여 실행 가능하다. 

 그러나, RPC의 경우 자신과 다른 주소공간에서 동작하는 프로세스의 함수를 실행할 수 있게 해주는데, 이는 네트워크를 통한 메시징을 수행하기 때문이다.

- Client-Server 간의 커뮤니케이션에 필요한 상세정보는 최대한 감춘다. (=> 언어나 환경에 구애를 받지 않는다! )

- Client와 Server는 각각 일반 메소드를 호출하는 것처럼 원격지의 프로시저를 호출할 수 있다.

![리다이렉트](/images/json-rpc.png)

rpc통신과정

1. 클라이언트는 클라이언트 Stub 을 호출한다.
2. 클라이언트 Stub 은 메시지로 매개변수를 패킹하고 메시지를 전송하는 시스템 호출    
3.클라이언트 로컬 OS 는 클라이언트에서 서버로 메시지 보낸다.    
4.서버 로컬 OS 는 들어오는 패킷을 서버 Stub 으로 보낸다.
5. 서버 Stub 은 메시지에서 매개변수 압축을 언패킹 한다.
이 때, 매개변수 압축 푸는 것을 언마샬링(Unmarshalling) 이라 한다.
6. 서버 Stub 은 서버 프로시저를 호출한다.
응답과 반환패킷은 반대 방향으로 동일한 단계를 거친다.

좀더 자세한 설명 
- 클라이언트는 클라이언트 스텁을 호출합니다. 호출은 일반적인 방식으로 스택에 푸시된 매개변수가 있는 로컬 프로시저 호출입니다.
- 클라이언트 스텁은 프로시저 매개변수를 메시지로 압축하고 메시지를 보내기 위해 시스템 호출을 합니다. 프로시저 매개변수의 패킹을 마샬링 이라고 합니다.
- 클라이언트의 로컬 OS는 클라이언트 시스템에서 원격 서버 시스템으로 메시지를 보냅니다.
- 서버 OS는 들어오는 패킷을 서버 스텁으로 전달합니다.
- 서버 스텁 은 메시지에서 언마샬링 이라고 하는 매개변수의 압축을 풉니다.
- 서버 프로시저가 완료되면 반환 값을 메시지로 마샬링하는 서버 스텁으로 반환됩니다. 그런 다음 서버 스텁은 메시지를 전송 계층에 전달합니다.
- 전송 계층은 결과 메시지를 클라이언트 전송 계층으로 다시 보내고, 클라이언트 전송 계층은 메시지를 클라이언트 스텁으로 다시 전달합니다.
- 클라이언트 스텁은 반환 매개변수를 비정렬화하고 실행은 호출자에게 반환됩니다.

RPC의 대표적인 구현체

- 구글의 ProtocolBuffer

- 페이스북의 Thrift

- 트위터의 Finalge

블록체인에서 RPC를 써먹는 이유

RPC가 필요한 이유는 무엇입니까?
- 블록체인(노드)과 통신하여 잔액정보등의 데이터를 가져오는 등의 통신을 하기 위해서

블록체인과 상호 작용하려면 잔액 보기, 트랜잭션 생성 또는 스마트 계약과 상호 작용하는 것과 같은 작업을 수행하기 위해 적절하고 일반적인 옵션을 통해 네트워크 서버(노드 클라이언드 단에서 api를 열어놓음)에 액세스할 수 있는 방법이 필요합니다. RPC는 서버와의 연결을 설정할 수 있는 기능을 제공합니다.

개발자가 RPC 기능이 있는 분산형 애플리케이션(dApp)을 만들면 사용자는 요청을 수행하고 블록체인과 상호 작용할 수 있습니다. 예를 들어 MetaMask와 같은 지갑을 연결하여 탈중앙화 거래소(DEX)를 사용한 적이 있다면 연결 및 통신이 블록체인 서버와 통신하기 위해 RPC를 통해 라우팅됩니다.