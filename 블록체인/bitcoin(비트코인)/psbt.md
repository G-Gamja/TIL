비트코인의 **PSBT (Partially Signed Bitcoin Transaction)**는 서명되지 않은 트랜잭션을 여러 사람이 공유하며

서명을 완성해나가는 표준 포맷입니다. 질문하신 `input`과 그 내부의 `UTXO` 필드들은 서명자가 "내가 정말 이 돈을 쓸 권한이 있는지" 확인하기 위해 필요한 핵심 정보들입니다.

---

### 1. PSBT에서 Input이란?

비트코인에서 **Input(입력)**은 "내가 새로 보낼 돈이 어디서 왔는가?"를 나타내는 **출처**입니다.

- 단순히 "얼마를 보낸다"가 아니라, **"이전 거래의 몇 번째 출력(UTXO)을 가져와서 쓰겠다"**는 정보를 담고 있습니다.
- PSBT의 `input` 맵에는 이 출처를 증명하고 서명하기 위해 필요한 데이터(공개키 정보, 스크립트 등)가 포함됩니다.

---

### 2. nonWitnessUtxo vs witnessUtxo

서명자는 자신이 서명하려는 자금이 가짜가 아닌지 확인해야 합니다. 이때 사용하는 방식이 구형(Legacy) 방식이냐, 신형(SegWit) 방식이냐에 따라 필드가 달라집니다.

| 구분            | **nonWitnessUtxo**                                                | **witnessUtxo**                                                                 |
| --------------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------- |
| **대상**        | **Legacy (비-세그윗)** 입력용                                     | **SegWit (세그윗)** 입력용                                                      |
| **포함 데이터** | 이전 거래 **전체(Full Transaction)** 데이터                       | 이전 거래 중 **해당 출력(TxOut)**만 포함                                        |
| **필요 이유**   | 서명 시 이전 거래 전체를 해시해야 수수료 위조 등을 방지할 수 있음 | 세그윗은 구조적으로 수수료 계산이 안전하여 출력값(Value)과 스크립트만 있으면 됨 |

> **쉽게 말하면:** > \* 예전 방식 주소에서 돈을 가져오면 **전체 영수증(`nonWitnessUtxo`)**이 필요하고,
>
> - 요즘 방식(SegWit, Taproot) 주소에서 가져오면 **해당 항목(`witnessUtxo`)**만 있으면 됩니다.

---

### 3. witnessUtxo 안의 script (scriptPubKey)

`witnessUtxo` 내부에 있는 `script`는 정확히 말하면 **`scriptPubKey`**를 의미합니다.

- **역할:** 이 돈을 쓰기 위해 풀어야 하는 **'자물쇠'**입니다.
- **내용:** 이 UTXO가 어떤 조건(예: 특정 공개키의 소유자여야 함)에서 사용될 수 있는지 정의되어 있습니다.
- **서명 과정에서의 중요성:** 서명자는 이 `script`를 보고 "아, 내 공개키로 서명해야 하는구나"를 판단하며, 실제 서명을 생성할 때 이 스크립트 데이터를 해시 연산에 포함시켜 보안을 유지합니다.

---

### 요약 구조도

- **Input**
- `hash` & `index`: 어떤 이전 거래의 몇 번째 돈인가? (Outpoint)
- **`nonWitnessUtxo`**: (Legacy일 때) 이전 거래 전체 데이터
- **`witnessUtxo`**: (SegWit일 때)
- `value`: 금액 (Satoshi 단위)
- **`script`**: 이 돈에 걸려 있는 잠금장치 (scriptPubKey)
