# canActivate

`canActivate` 함수는 NestJS의 가드에서 사용되는 메서드입니다. 가드는 특정 라우트에 대한 요청을 처리하기 전에 실행되며, 주로 인증이나 권한 검사 등의 목적으로 사용됩니다.

`canActivate` 메서드는 boolean 값을 반환하며, 이 값에 따라 요청이 라우트 핸들러에 도달할지 결정됩니다.

- `canActivate`가 `true`를 반환하면, 요청은 라우트 핸들러에 도달하고 처리됩니다.
- `canActivate`가 `false`를 반환하면, 요청은 라우트 핸들러에 도달하지 않고 거부됩니다.

`canActivate` 메서드는 `ExecutionContext` 인스턴스를 매개변수로 받습니다. 이를 통해 요청, 응답, 라우트 핸들러 등의 정보에 접근할 수 있습니다. 이 정보를 사용하여 인증 상태를 확인하거나, 사용자의 권한을 검사하는 등의 작업을 수행할 수 있습니다.

# Middleware

## Middleware 와 Guard의 차이점

NestJS에서 Guard와 Middleware는 비슷해 보일 수 있지만, 그들의 역할과 사용 방식은 다릅니다.

**Middleware**:

- 미들웨어는 요청과 응답 객체에 접근할 수 있으며, 요청-응답 사이클을 조작할 수 있습니다.
- 미들웨어는 주로 로깅, 에러 핸들링, 요청 본문의 파싱 등의 역할을 합니다.
- 미들웨어는 다음 미들웨어로 요청을 전달하거나, 요청-응답 사이클을 종료할 수 있습니다.
- 미들웨어는 모든 요청에 대해 실행되며, 특정 라우트나 컨트롤러에 대해 실행되지 않습니다.

**Guard**:

- 가드는 요청이 특정 라우트 핸들러에 도달하기 전에 실행됩니다.
- 가드는 주로 인증이나 권한 검사 등의 목적으로 사용됩니다.
- 가드가 `true`를 반환하면 요청은 다음 단계로 진행되고, `false`를 반환하면 요청은 여기에서 종료됩니다.
- 가드는 특정 라우트나 컨트롤러에 대해 실행될 수 있습니다.

따라서, 미들웨어는 요청-응답 사이클을 조작하는 데 사용되며, 가드는 요청이 특정 라우트 핸들러에 도달하기 전에 검사를 수행하는 데 사용됩니다.

## Middleware 와 Guard의 실행순서

NestJS에서 요청이 들어오면 다음의 순서대로 처리 과정이 실행됩니다:

1. **Middleware**: 먼저 미들웨어가 실행됩니다. 미들웨어는 요청과 응답 객체에 접근할 수 있으며, 요청-응답 사이클을 조작할 수 있습니다. 미들웨어는 다음 미들웨어로 요청을 전달하거나, 요청-응답 사이클을 종료할 수 있습니다.

2. **Guard**: 미들웨어가 요청을 다음 단계로 전달하면, 가드가 실행됩니다. 가드는 요청이 특정 라우트 핸들러에 도달하기 전에 실행되며, 주로 인증이나 권한 검사 등의 목적으로 사용됩니다. 가드가 `true`를 반환하면 요청은 다음 단계로 진행되고, `false`를 반환하면 요청은 여기에서 종료됩니다.

따라서 요청이 들어오면 먼저 미들웨어가 실행되고, 그 다음에 가드가 실행됩니다. 이 두 단계를 모두 통과한 요청만이 최종적으로 라우트 핸들러에 도달하게 됩니다.
